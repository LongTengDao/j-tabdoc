/*!
 * 模块名称：jTabDoc
 * 模块功能：TabDoc 的官方标准实现。从属于“简计划”。
   　　　　　The official standard implementation of TabDoc. Belong to "Plan J".
 * 模块版本：2.1.1
 * 许可条款：LGPL-3.0
 * 所属作者：龙腾道 <LongTengDao@LongTengDao.com> (www.LongTengDao.com)
 * 问题反馈：https://GitHub.com/LongTengDao/j-tabdoc/issues
 * 项目主页：https://GitHub.com/LongTengDao/j-tabdoc/
 */
(function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).jTabDoc=r()})(this,function(){"use strict";var O,r=Object.prototype.toString,v=Array.prototype.push,w=Array.isArray||function w(e){return"[object Array]"===r.call(e)};if("function"==typeof Buffer){var p=Buffer.isBuffer;if("function"==typeof p&&"function"==typeof Buffer.from)var n=Buffer.hasOwnProperty("from")?Buffer.from:function n(e){return new Buffer(e)},s=function s(e){switch(e[0]){case 239:if(187===e[1]&&191===e[2])return e.slice(3).toString("utf8");break;case 255:if(254===e[1])return e.slice(2).toString("ucs2");break;case 254:if(255===e[1])return(e=n(e)).swap16().slice(2).toString("ucs2")}return e.toString()};else p=function p(){return!1}}else p=function p(){return!1};var o,c=/^[1-9]\d*$/,y="".repeat?function y(e){return" ".repeat(e)}:(o=[],function(e){return o.length=e+1,o.join(" ")});function g(e){for(var r=e.length,n=0;n<r;++n)if("string"!=typeof e[n])return!0;return!1}var h=/^\uFEFF/,b=/\r\n?|\n/;function T(e,r,n,o,t,i,f,a){var l=[],u=r.length-1,p=0,s=0===r[0].length;e:for(;;){var c=p;if(s)if(o)for(;;){if(p===u){l.push(p+1-c);break e}if(0!==r[++p].length){l.push(p-c),s=!1;break}}else for(;;){if(p===u)break e;if(0!==r[++p].length){s=!1;break}}else for(;;){if(p===u){n(e,l,o,t,i,r,c,p,f,a);break e}if(0===r[++p].length){n(e,l,o,t,i,r,c,p-1,f,a),s=!0;break}}}return l.number=f,null===i?l:i(l,e)}function j(e,r,n,o,t,i,f,a,l,u){var p,s,c;e:for(var h=f,y=i[h],b=y.indexOf("\t");;){if(s=[],c=l+h,-1===b)for(p="",s.push(y);;){if(h===a)break e;if(-1!==(b=(y=i[++h]).indexOf("\t")))break;s.push(y)}else{for(0===b?(p="\t",s.push(y.slice(1))):(p=y.slice(0,b+1),s.push(y.slice(b+1)));;){if(h===a){null===o&&(s=T(e,s,j,n,null,t,c,u));break e}if(0!==(b=(y=i[++h]).indexOf("\t")))break;s.push(y.slice(1))}null===o&&(s=T(e,s,j,n,null,t,c,u))}r.push({key:p,value:s,number:c})}r.push({key:p,value:s,number:c})}function D(e,r,n,o,t,i,f,a,l,u){var p,s,c,h=[],y="";e:for(var b=f,v=i[b],w=v.indexOf("\t");;){if(s=[],c=l+b,-1===w)for(p="",s.push(v),y+="\n";;){if(b===a)break e;if(-1!==(w=(v=i[++b]).indexOf("\t")))break;s.push(v)}else for(0===w?(p="\t",s.push(v.slice(1)),y+="\t\n"):(y+=(p=v.slice(0,w+1))+"\n",s.push(v.slice(w+1)));;){if(b===a)break e;if(0!==(w=(v=i[++b]).indexOf("\t")))break;s.push(v.slice(1))}h.push({key:p,value:s,number:c})}if(h.push({key:p,value:s,number:c}),!0===o)return r.push(1===h.length?h[0]:h),void 0;for(var g=o[0],T=o.length,j=0,D=g;;){var E=D[0].exec(y);if(null===E){if(++j===T)throw new Error("jTabDoc.parse(,reviver.group[!])");D=o[j]}else{if(u){if(E===O)throw new Error("jTabDoc.parse(,reviver.group[*][0].exec())");if(E.index)throw new Error("jTabDoc.parse(,reviver.group[*][0].exec().index)");if("string"!=typeof E[0])throw new TypeError("jTabDoc.parse(,reviver.group[*][0].exec()[0])");if(0===E[0].length)throw new Error("jTabDoc.parse(,reviver.group[*][0].exec()[0].length)");if("\n"!==E[0].charAt(E[0].length-1))throw new Error("jTabDoc.parse(,reviver.group[*][0].exec()[0])")}var d=E[0],k=d.length;if(y.length===k){if(r.push(D[1](1===h.length?h[0]:h,e)),u&&r[r.length-1]===O)throw new TypeError("jTabDoc.parse(,reviver.group[*][1]())");return}for(var m=1,x=d.indexOf("\n");!((x=d.indexOf("\n",x+1))<0);++m);if(r.push(D[1](1===m?h.shift():h.splice(0,m),e)),u&&r[r.length-1]===O)throw new TypeError("jTabDoc.parse(,reviver.group[*][1]())");y=y.slice(k),j=0,D=g}}}function E(e,r,n,o){var t=o.length;if(0===t)e.push(r);else{e.push(r+o[0]);for(var i=1;i<t;++i)e.push(n+o[i])}}function d(e,r){if("object"==typeof e&&null!==e){if(!("key"in e&&"value"in e))throw new Error("jTabDoc.stringify("+(r?",replacer()":"level")+"[*]:object)");if("string"!=typeof e.key||!/^(?:[^\t\n\r]*\t)?$/.test(e.key))throw new Error("jTabDoc.stringify("+(r?",replacer()":"level")+"[*]:object.key)");if(null!==r||""===e.key){if(!w(e.value))throw new TypeError("jTabDoc.stringify("+(r?",replacer()":"level")+"[*]:object.value)");if(g(e.value))throw new TypeError("jTabDoc.stringify("+(r?",replacer()":"level")+"[*]:object.value[*])")}}else{if("number"!=typeof e)throw new TypeError("jTabDoc.stringify("+(r?",replacer()":"level")+"[*])");if(!/^\d+$/.test(e))throw new Error("jTabDoc.stringify("+(r?",replacer()":"level")+"[*]:number)")}}var e={parse:function k(e,r,n,o){if(w(e)||("string"==typeof e?e=e.replace(h,"").split(b):p(e)&&(e=s(e).split(b))),null==r)var t=!0,i=null,f=null;else t=r.empty,i=r.group,f=r.level,t===O&&(t=!0),i===O&&(i=null),f===O&&(f=null);if(n===O&&(n=1),!1!==o){if(4<arguments.length)throw new Error("jTabDoc.parse(tabLines, reviver, number, debug, ...)");if(o===O)o=!0;else if(!0!==o)throw new TypeError("jTabDoc.stringify(,,,debug)");if(!w(e))throw new TypeError("jTabDoc.parse(tabLines)");if(g(e))throw new TypeError("jTabDoc.parse(tabLines[*])");if("boolean"!=typeof t)throw new TypeError("jTabDoc.parse(,reviver.empty)");if(null!==i&&"boolean"!=typeof i){if(!w(i))throw new TypeError("jTabDoc.parse(,reviver.group)");var a=i.length;if(!a)throw new Error("jTabDoc.parse(,reviver.group.length)");var l=0;do{var u=i[l];if(!u)throw new TypeError("jTabDoc.parse(,reviver.group[*])");if(!u[0]||"function"!=typeof u[0].exec)throw new TypeError("jTabDoc.parse(,reviver.group[*][0])");if("function"!=typeof u[1])throw new TypeError("jTabDoc.parse(,reviver.group[*][1])")}while(++l<a)}if(null!==f&&"function"!=typeof f)throw new TypeError("jTabDoc.parse(,reviver.level)");if("number"!=typeof n)throw new TypeError("jTabDoc.parse(,,number)");if(!c.test(n))throw new RangeError("jTabDoc.parse(,,number)")}return 0===e.length?null===f?[]:f([],this):T(this,e,i?D:j,t,i,f,n,o)},stringify:function t(e,r,n,o){if(!1!==o){if(4<arguments.length)throw new Error("jTabDoc.stringify(level, replacer, space, debug, ...)");if(o===O)o=!0;else if(!0!==o)throw new TypeError("jTabDoc.stringify(,,,debug)");if(null!=r&&"function"!=typeof r)throw new TypeError("jTabDoc.stringify(,replacer)");if(null!=n&&"function"!=typeof n)throw new TypeError("jTabDoc.stringify(,,space)")}return r===O&&(r=null),n===O&&(n=null),function b(e,r,n,o,t){if(null!==n&&(r=n(r,e)),t&&!w(r))throw new TypeError("jTabDoc.stringify(level)");for(var i=[],f=r.length,a=0;a<f;++a){var l=r[a];if(t&&d(l,n),"number"==typeof l)for(;l--;)i.push("");else if(""===l.key)v.apply(i,l.value);else if(null===o)E(i,l.key,"\t",null===n?b(e,l.value,null,o,t):l.value);else{for(var u=[l.key],p=[l.value];++a<f;){if(l=r[a],t&&d(l,n),"number"==typeof l){--a;break}u.push(l.key),p.push(l.value)}var s=o(u,e);if(t){if("object"!=typeof s||null===s)throw new TypeError("jTabDoc.stringify(,,space())");if(!("keys"in s&&"indent"in s))throw new Error("jTabDoc.stringify(,,space())");if(!w(s.keys))throw new TypeError("jTabDoc.stringify(,,space().keys)");if(s.keys.length!==p.length)throw new Error("jTabDoc.stringify(,,space().keys.length)");if(g(s.keys))throw new TypeError("jTabDoc.stringify(,,space().keys[*])");if("string"!=typeof s.indent)throw new TypeError("jTabDoc.stringify(,,space().indent)")}u=s.keys;for(var c=s.indent,h=p.length,y=0;y<h;++y)""===u[y]?v.apply(i,p[y]):E(i,u[y],c,null===n?b(e,p[y],null,o,t):p[y])}}return i}(this,e,r,n,o)},Space:function i(r,n){if("number"!=typeof r)throw new TypeError("jTabDoc.Space(minWidth)");if("number"!=typeof n)throw new TypeError("jTabDoc.Space(,padding)");var o=r<0;if(o&&(r=~r),!c.test(r))throw new RangeError("jTabDoc.Space(minWidth)");if(!c.test(n))throw new RangeError("jTabDoc.Space(,padding)");return function(e){return function h(e,r,n,o){for(var t=1,i=[],f=o.length,a=0;a<f;++a){var l=0,u=o[a];if(""!==u){for(var p=u.length-1,s=0;s<p;++s){var c=u.charCodeAt(s);c<128?l+=1:(l+=2,55296<=c&&c<=56319&&s+1<p&&56320<=(c=u.charCodeAt(s+1))&&c<=57343&&++s)}t<l&&(t=l)}i.push(l)}for(l=t+n,e?l%r&&(l+=r-l%r):l<r&&(l=r),a=0;a<f;++a)""!==(u=o[a])&&(o[a]=u.slice(0,-1)+y(l-i[a]));return{keys:o,indent:y(l)}}(o,r,n,e)}},version:"2.1.1"};return e["default"]=e});
//# sourceMappingURL=j-tabdoc.min.js.map